# avyos

**avyos** is a minimal, experimental operating system project.

The goal of avyos is to explore how far a mostly **pure Go** system can go, while keeping the system simple, readable, and hackable.

> âš ï¸ Experimental project. Things *will* break.

---

<p align="center">
  <img src="docs/preview.png" alt="avyos preview" width="600"/>
</p>

## Goals

- Build a **full operating system in Go**
- Keep components small, explicit, and easy to understand
- Prefer clarity and control over POSIX compatibility
- Gradually eliminate legacy dependencies

---

## Roadmap

1. **Bootstrap phase**  
   Build a usable operating system by **reusing existing components**:
   - Linux kernel
   - GCC toolchain
   - Mesa
   - Wayland / wlroots
   - Traditional C libraries where unavoidable

2. **Replacement phase**  
   Incrementally replace reused components with **simple, pure Go**
   implementations:
   - init system
   - service manager
   - IPC bus
   - shell
   - device management
   - userspace libraries
   - graphics and input stack

The system is expected to stay **bootable and usable at every step**.

---

## Current Status

avyos has crossed the â€œtoy OSâ€ stage and is now a **working experimental system**.

### Core system

- âœ… Fully bootable disk image generated by the avyos build system
- âœ… QEMU-based development workflow
- âœ… Modified, non-standard Unix-like root filesystem layout
- âœ… Custom **init** and **service model**

### Shell

- âœ… **Lipi shell** implemented and fully usable  
  - Lisp-inspired
  - Not POSIX, not `/bin/sh` compatible
  - Designed specifically for avyos

### Graphics & UI

- âœ… Wayland stack working
- âœ… **Mesa** providing hardware-accelerated graphics
- âœ… **wlroots + dwl compositor** running successfully
- âœ… Accelerated rendering confirmed

### Toolchain & externals

- âœ… **36 external components** integrated
- âœ… Full **GCC compiler toolchain**
- âœ… Mesa, Wayland, wlroots, libinput, and supporting libraries

### IPC & Services

- âœ… Working IPC service bus named **`connect`**
- âœ… Used by **init** and system **services**
- âœ… Designed for structured, binary IPC (no JSON or strings in hot paths)
- âœ… **apigen** tool implemented
- âœ… Generates **client-side and service-side IPC code**
- âœ… Uses API specifications located at:
  ```
  /api/<service>/api.json
  ```

---

## Build & Run

Build everything (kernel, userland, rootfs, disk image):

```sh
make
```

Run on amd64 using QEMU:

```sh
make -C device/amd64 run
```

---

## Code Layout

| Directory     | Purpose                                       |
| ------------- | --------------------------------------------- |
| `_external/`  | External source code (third-party components) |
| `api/`        | Api specification and generated go code       |
| `build/`      | Toolchains and build tools                    |
| `cmd/`        | System commands                               |
| `config/`     | Configuration files                           |
| `data/`       | Fonts, images, icons, and static assets       |
| `device/`     | Device / architecture-specific targets        |
| `init/`       | Init systems and kernels                      |
| `init/kernel` | Linux kernel (current)                        |
| `init/sutra`  | Experimental pure-Go â€œkernelâ€                 |
| `lib/`        | Required C libraries                          |
| `pkg/`        | Go packages                                   |
| `scripts/`    | Helper and build scripts                      |
| `services/`   | System services                               |
| `api/`        | IPC API specifications (`api.json`)           |
| `tools/`      | Build tools (including `apigen`)              |

---

## Notes

- âŒ Not POSIX-compliant (by design)
- âŒ Not a traditional Unix system
- âš ï¸ APIs, layouts, and interfaces are unstable
- ğŸ” Frequent refactors are expected
- ğŸ¯ Primary focus: **clarity, control, and Go-first design**
